      SUBROUTINE CONFR(TLOSS, NP, FREQ,
     & COHINC, NMARCH, 
     & TITLE, IOP,
     & MINFRQ, NFREQ, FF,
     & FLAG, AX, AY, SRD, SECD,
     & NOPT, ICF, KSRD)

      CHARACTER*3 COHINC, BWCOL, XBTYPE, YBTYPE
      CHARACTER*80 TITLE, TITLEX, TITLEY
      CHARACTER*16 OPTION
      CHARACTER*20 FILENM

      REAL NRNG
      REAL FF(*)
      REAL TLOSS(*)
      REAL FLAG(NOPT,ICF), AX(NOPT,6), AY(NOPT,7)
      REAL SRD(NOPT,KSRD,2)
      REAL SECD(NOPT,3)
      REAL SECTOR(28)

      COMMON /CONTUR/ CNTR1(4,4)
      COMMON /LUCONT/ LUCDR, LUBDR, LUCFR, LUBFR
      COMMON /XAXC/ TITLEX, XBTYPE
      COMMON /YAXC/ TITLEY, YBTYPE


      DATA X1PL, Y1PL /2.0,2.0/,HGTPT,HGTC,LABPT,NDIV,
     &     NARC/0.1,0.14,-3,1,5/,LABC,LWGT/-1,1/
      DATA CAY, NRNG /5.0, 5.0/
      DATA DUMMY /0./

  120 FORMAT(5E15.4)
  150 FORMAT('CONFR,',A3,',',A3,'   ')
  190 FORMAT(1H ,F15.4,4X,' DUMMY ' )
  191 FORMAT(1H ,F15.4,4X,' DIVX ' )
  192 FORMAT(1H ,F15.4,4X,' DIVY ' )
  201 FORMAT(1H ,F15.4,4X,' NX: NUMBER OF GRID POINTS IN RANGE ')
  202 FORMAT(1H ,F15.4,4X,' NY: NUMBER OF GRID POINTS IN FREQUENCY ')
  203 FORMAT(1H ,F15.4,4X,' RMIN ')
  204 FORMAT(1H ,F15.4,4X,' RMAX ')
  205 FORMAT(1H ,F15.4,4X,' MIN FREQUENCY ')
  206 FORMAT(1H ,F15.4,4X,' MAX FREQUENCY ')
  207 FORMAT(1H ,F15.4,4X,' CAY ')
  208 FORMAT(1H ,F15.4,4X,' NRNG ')
  209 FORMAT(1H ,F15.4,4X,' LWGT ')
  210 FORMAT(1H ,F15.4,4X,' NPY: NUMBER OF FREQUENCIES ')
  211 FORMAT(1H ,F15.4,4X,' NPX: NUMBER OF POINTS IN RANGE ')
  212 FORMAT(1H ,F15.4,4X,' NDIV: NUMBER OF DIVISIONS ')
  213 FORMAT(1H ,F15.4,4X,' NARC: NUMBER OF ARCS ')
  214 FORMAT(1H ,F15.4,4X,' HGTPT ')
  215 FORMAT(1H ,F15.4,4X,' HGTC ')
  216 FORMAT(1H ,F15.4,4X,' LABPT ')
  217 FORMAT(1H ,F15.4,4X,' X ORIGIN OF PLOT IN INCHES ')
  219 FORMAT(1H ,F15.4,4X,' Y ORIGIN OF PLOT IN INCHES ')
  221 FORMAT(1H ,F15.4,4X,' ZMIN ')
  222 FORMAT(1H ,F15.4,4X,' ZMAX ')
  223 FORMAT(1H ,F15.4,4X,' ZLEV ')
  224 FORMAT(1H ,F15.4,4X,' LABC ')
  225 FORMAT(1H ,F15.4,4X,' NSM   ')
  227 FORMAT(1H ,F15.4,4X,' DELTAX ')
  229 FORMAT(1H ,F15.4,4X,' XLEFT',
     & /,1X,F15.4,4X,' XRIGHT',
     & /,1X,F15.4,4X,' X AXIS LENGTH IN CM ',
     & /,1X,F15.4,4X,' XINC')
  230 FORMAT(1H ,F15.4,4X,' YUP',
     & /,1X,F15.4,4X,' YDOWN',
     & /,1X,F15.4,4X,' Y AXIS LENGTH IN CM ',
     & /,1X,F15.4,4X,' YINC')
  231 FORMAT(1H ,F15.4,4X,' SOURCE DEPTH ')
  232 FORMAT(1H ,F15.4,4X,' RECEIVER DEPTH ')
C  550 FORMAT('FR',A3,I2.2,'.CDR         ')
C  670 FORMAT('$ @CONTUR  FR',A3,I2.2)
  760 FORMAT(A3)
  800 FORMAT(A16)
  810 FORMAT(A20)
  820 FORMAT('Range (km)  ',17('    '))
  840 FORMAT('Frequency (Hz)  ',16('    '))
  850 FORMAT(A80)


      DO 1000   IS= 3, 28
      SECTOR(IS)= 0.0
 1000 CONTINUE
      SECTOR(1)= NP
      SECTOR(2)= FREQ

      WRITE(LUBFR,120) SECTOR
      WRITE(LUBFR,120) (TLOSS(J), J= 1, NP)

      IF( FREQ .LT. FF(NFREQ) )   RETURN
      CLOSE(LUBFR)

C  DEFINITION OF CONSTANTS.
      FILENM= ' '
      DIVX=1.0E-3
      DIVY=1.0
      XBTYPE='LIN'
      YBTYPE='LOG'
      WRITE(TITLEX,820)
      WRITE(TITLEY,840)
      MAXFRQ= NFREQ

      IF(FLAG(IOP,4) .GT. 0.0 )   THEN
        BWCOL= 'COL'
      ELSE
        BWCOL= 'B/W'
      END IF


C   TRANSFER TO OUTPUT FILES OF CONTOUR PARAMETERS


      WRITE(OPTION,150) COHINC, BWCOL
      WRITE(LUCFR,800) OPTION
      WRITE(LUCFR,850) TITLE
      FILENM(1:19)= '"INPUT_FILE"_FR.BDR'
      WRITE(LUCFR,810) FILENM
      WRITE(LUCFR,850) TITLEX
      WRITE(LUCFR,760) XBTYPE
C   Minimum data value along X axis
      WRITE(LUCFR,203) SECD(IOP,1)  
C   Maximum data value along X axis
      WRITE(LUCFR,204) SECD(IOP,2)  
C   X axis specification for plot
      XLEN=ABS((AX(IOP,1)-AX(IOP,2))/AX(IOP,3))
      XINC= MIN(AX(IOP,2) - AX(IOP,1), AX(IOP,4))
      WRITE(LUCFR,229) AX(IOP,1), AX(IOP,2), XLEN, XINC
      WRITE(LUCFR,850) TITLEY
      WRITE(LUCFR,760) YBTYPE
C   Y axis specification for plot
      YLEN= AY(IOP,3)
      WRITE(LUCFR,230) AY(IOP,1),AY(IOP,2),YLEN,AY(IOP,4)
C   NUMBER OF DATA POINTS ALONG X AXIS (range)
      WRITE(LUCFR,211) FLOAT(NP)          
C   NUMBER OF DATA POINTS ALONG Y AXIS (frequency)
      NF=MAXFRQ-MINFRQ+1
      WRITE(LUCFR,210) FLOAT(NF)          
      WRITE(LUCFR,191) DIVX
      WRITE(LUCFR,192) DIVY
      WRITE(LUCFR,190) DUMMY
C   Minimum data value along Y axis
      WRITE(LUCFR,205) FF(MINFRQ)  
C   Maximum data value along Y axis
      WRITE(LUCFR,206) FF(MAXFRQ)  
C   SOURCE DEPTH
      WRITE(LUCFR,231) ABS(SRD(IOP,1,1))
C   NUMBER OF GRID POINTS (NX)
      WRITE(LUCFR,201) FLOAT(NP)          
C   NUMBER OF GRID POINTS (NY)
      WRITE(LUCFR,202) FLOAT(NF)          
C   RECEIVER DEPTH
      WRITE(LUCFR,232) SRD(IOP,1,2)   
C   WRITING OF DELTAX
      WRITE(LUCFR,227) SECD(IOP,3)   
      WRITE(LUCFR,207) CAY
      WRITE(LUCFR,208) NRNG
C   Contour levels ( ZMIN, ZMAX, ZLEV )
      WRITE(LUCFR,221) CNTR1(2,1)  
      WRITE(LUCFR,222) CNTR1(2,2)  
      WRITE(LUCFR,223) CNTR1(2,3)  
      WRITE(LUCFR,217) X1PL
      WRITE(LUCFR,190) DUMMY
      WRITE(LUCFR,219) Y1PL
C   Number of smoothings
      NSM= MAX(0, NINT(CNTR1(2,4)))
      WRITE(LUCFR,225) FLOAT(NSM)
      WRITE(LUCFR,214) HGTPT
      WRITE(LUCFR,215) HGTC
      WRITE(LUCFR,216) FLOAT(LABPT)
      WRITE(LUCFR,212) FLOAT(NDIV)
      WRITE(LUCFR,213) FLOAT(NARC)
      WRITE(LUCFR,224) FLOAT(LABC)
      WRITE(LUCFR,209) FLOAT(LWGT)
      CLOSE(LUCFR)
C      WRITE(12,670) COHINC, NMARCH

C  END OF LOOP FOR TRANSFER OF FIXED PARAMETERS.

      RETURN
      END
